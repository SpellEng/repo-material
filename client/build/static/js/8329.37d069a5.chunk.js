"use strict";(self.webpackChunkSpellEng=self.webpackChunkSpellEng||[]).push([[8329],{93884:(e,s,t)=>{t.d(s,{$p:()=>n,C9:()=>i});var a=t(22019);const i=e=>{a.Ay.success({className:"ant-message",content:e,duration:4,style:{marginTop:"40px"}})},n=e=>{a.Ay.error({className:"ant-message",content:e,duration:4,style:{marginTop:"40px"}})}},58329:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var a=t(65043),i=t(86213),n=t(87021),l=t(54522),o=t(31103),r=t(73216),c=t(86178),d=t.n(c),u=t(93884),h=t(70579);const p=()=>{const e=(0,r.Zp)(),[s,t]=(0,a.useState)([]),[c,p]=(0,a.useState)(!1),[v,m]=(0,a.useState)([]),[x,g]=(0,a.useState)([]),[j,w]=(0,a.useState)([]),[f,y]=(0,a.useState)([]),b=async()=>{try{var e;const s=await i.A.get("".concat("https://www.spelleng.com/api","/subscriptions/user/").concat(null===(e=(0,o.wR)())||void 0===e?void 0:e._id),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t(s.data)}catch(s){console.error("Error fetching subscriptions:",s)}};return(0,a.useEffect)((()=>{b(),(async()=>{var e;await i.A.get("".concat("https://www.spelleng.com/api","/scheduled-classes/student/future/").concat(null===(e=(0,o.wR)())||void 0===e?void 0:e._id),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>{var s;p(!1),200===e.status?w(null===(s=e.data)||void 0===s?void 0:s.filter((e=>!(null!==e&&void 0!==e&&e.trialClass)))):(0,u.$p)(e.data.errorMessage)})).catch((e=>{p(!1),console.log(e),(0,u.$p)(null===e||void 0===e?void 0:e.message)}))})(),(async()=>{var e;await i.A.get("".concat("https://www.spelleng.com/api","/scheduled-classes/student/past/").concat(null===(e=(0,o.wR)())||void 0===e?void 0:e._id),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>{var s;p(!1),200===e.status?y(null===(s=e.data)||void 0===s?void 0:s.filter((e=>!(null!==e&&void 0!==e&&e.trialClass)))):(0,u.$p)(e.data.errorMessage)})).catch((e=>{p(!1),console.log(e),(0,u.$p)(null===e||void 0===e?void 0:e.message)}))})(),(async()=>{var e;await i.A.get("".concat("https://www.spelleng.com/api","/scheduled-classes/student/cancelled/").concat(null===(e=(0,o.wR)())||void 0===e?void 0:e._id),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>{if(p(!1),200===e.status){var s;m(e.data);const t=d()().startOf("month").toDate(),a=d()().startOf("month").add(1,"month").toDate(),i=null===(s=e.data)||void 0===s?void 0:s.filter((e=>{const s=d()(e.date,"DD/MM/YYYY").toDate();return s>=t&&s<a}));g(i)}else(0,u.$p)(e.data.errorMessage)})).catch((e=>{p(!1),console.log(e),(0,u.$p)(null===e||void 0===e?void 0:e.message)}))})()}),[]),(0,a.useEffect)((()=>{(async()=>{const e=new Date;for(let a of s){if(new Date(a.expiryDate)<e&&"expired"!==a.status)try{await i.A.put("".concat("https://www.spelleng.com/api","/subscriptions/update-status/").concat(a._id),{status:"expired"},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((e=>{200===e.status&&b()}))}catch(t){console.error("Error updating subscription status:",t)}}})()}),[s]),(0,h.jsx)("div",{className:"subscriptions-container",children:(0,h.jsxs)("div",{className:"container",children:[(0,h.jsxs)("div",{className:"text-center mt-4",children:[(0,h.jsx)("h4",{children:"Buy Subscription"}),(0,h.jsx)(n.Ay,{className:"btn h-auto py-2 px-5 mt-3",type:"primary",onClick:()=>e("/subscription"),children:"Buy Now"})]}),(0,h.jsx)(l.A,{grid:{gutter:16,column:1},dataSource:s,className:"mt-2",renderItem:e=>(0,h.jsx)(l.A.Item,{children:(0,h.jsxs)("div",{className:"subscriptionsItem",children:[(0,h.jsx)("h3",{children:"Active Plan"}),(0,h.jsxs)("div",{className:"inner",children:[(0,h.jsx)("h2",{children:null===e||void 0===e?void 0:e.plan}),(0,h.jsxs)("p",{className:"mb-4",children:[(0,h.jsxs)("b",{children:[null===e||void 0===e?void 0:e.classesPerMonth," sessions"]})," per month"]}),"expired"===(null===e||void 0===e?void 0:e.status)?(0,h.jsx)("div",{className:"subsctiptionStatus expired",children:(0,h.jsxs)("p",{children:["Your subscription has been expired on ",(0,h.jsx)("b",{children:d()(e.expiryDate).format("MMMM DD, YYYY")})]})}):(0,h.jsx)("div",{className:"subsctiptionStatus",children:(0,h.jsxs)("p",{children:["Your subscription will expire on ",(0,h.jsx)("b",{children:d()(e.expiryDate).format("MMMM DD, YYYY")})]})}),(0,h.jsxs)("div",{className:"items",children:[(0,h.jsxs)("div",{className:"item",children:[(0,h.jsxs)("h5",{children:[(null===f||void 0===f?void 0:f.length)+(null===j||void 0===j?void 0:j.length),"/",null===e||void 0===e?void 0:e.classesPerMonth]}),(0,h.jsx)("p",{children:"Total sessions left"})]}),(0,h.jsxs)("div",{className:"item",children:[(0,h.jsx)("h5",{children:null===v||void 0===v?void 0:v.length}),(0,h.jsx)("p",{children:"Sessions Cancelled"})]}),(0,h.jsxs)("div",{className:"item",children:[(0,h.jsx)("h5",{children:null===x||void 0===x?void 0:x.length}),(0,h.jsx)("p",{children:"Monthly Cancelled Sessions"})]}),(0,h.jsxs)("div",{className:"item",children:[(0,h.jsx)("h5",{children:d()(e.expiryDate).format("MMMM DD, YYYY")}),(0,h.jsx)("p",{children:"Expires on"})]})]})]})]})})})]})})}}}]);
//# sourceMappingURL=8329.37d069a5.chunk.js.map